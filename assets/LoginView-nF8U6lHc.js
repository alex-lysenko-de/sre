import{g,a as f,b as h,i as w,q as y,u as _,j as s,k as t,n as i,s as n,t as k,m as u,o as a}from"./vue-vendor-C77FZFBx.js";import{u as z}from"./index-C8xB7GOY.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./supabase-D4wOtLzw.js";const L={class:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 to-purple-100 px-4"},M={class:"max-w-md w-full"},B={class:"bg-white rounded-2xl shadow-xl p-8"},V={key:0,class:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg"},j={key:1,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"},A={class:"flex items-start"},H={class:"flex-1"},N={class:"text-sm text-red-700 mt-1"},R=["disabled"],S={key:0,class:"animate-spin -ml-1 mr-3 h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24"},D={key:1,class:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},I={key:2},q={key:3},E={key:0,class:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},Q=g({__name:"LoginView",setup(T){const v=_(),m=y(),{login:p,isLoading:r,isAuthenticated:b}=z(),o=f(null),d=f(!1),c=h(()=>window.PublicKeyCredential!==void 0);w(()=>{m.query.registered==="true"&&(d.value=!0,setTimeout(()=>{d.value=!1},5e3)),b.value&&v.push("/dashboard"),c.value||(o.value="Ваше устройство не поддерживает биометрическую аутентификацию.")});async function x(){o.value=null;try{await p(),v.push("/dashboard")}catch(l){l.message.includes("not found")||l.message.includes("NotAllowedError")?o.value="Устройство не зарегистрировано. Попросите QR-код для регистрации.":o.value=l.message||"Ошибка входа",console.error("Login error:",l)}}return(l,e)=>(a(),s("div",L,[t("div",M,[t("div",B,[e[5]||(e[5]=n('<div class="text-center mb-8" data-v-4b734f36><div class="mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4" data-v-4b734f36><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-4b734f36><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" data-v-4b734f36></path></svg></div><h2 class="text-3xl font-bold text-gray-900" data-v-4b734f36>Вход</h2><p class="text-gray-600 mt-2" data-v-4b734f36>Войдите с помощью биометрии</p></div>',1)),d.value?(a(),s("div",V,[...e[0]||(e[0]=[n('<div class="flex items-start" data-v-4b734f36><svg class="w-5 h-5 text-green-600 mt-0.5 mr-3" fill="currentColor" viewBox="0 0 20 20" data-v-4b734f36><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" data-v-4b734f36></path></svg><div class="flex-1" data-v-4b734f36><p class="text-sm text-green-800" data-v-4b734f36>Вы успешно зарегистрированы! Теперь войдите в систему.</p></div></div>',1)])])):i("",!0),o.value?(a(),s("div",j,[t("div",A,[e[2]||(e[2]=t("svg",{class:"w-5 h-5 text-red-600 mt-0.5 mr-3",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("div",H,[e[1]||(e[1]=t("h3",{class:"text-sm font-medium text-red-800"},"Ошибка",-1)),t("p",N,k(o.value),1)])])])):i("",!0),t("button",{onClick:x,disabled:u(r),class:"w-full py-4 px-6 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-medium rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-lg"},[u(r)?(a(),s("svg",S,[...e[3]||(e[3]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),s("svg",D,[...e[4]||(e[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"},null,-1)])])),u(r)?(a(),s("span",q,"Вход...")):(a(),s("span",I,"Войти с биометрией"))],8,R),e[6]||(e[6]=n('<div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-4b734f36><div class="flex items-start" data-v-4b734f36><svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" data-v-4b734f36><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" data-v-4b734f36></path></svg><div class="flex-1" data-v-4b734f36><h4 class="text-sm font-medium text-blue-900" data-v-4b734f36>Как это работает</h4><ul class="mt-2 text-sm text-blue-800 space-y-1" data-v-4b734f36><li data-v-4b734f36>• Нажмите кнопку входа</li><li data-v-4b734f36>• Подтвердите вход через Face ID / Touch ID</li><li data-v-4b734f36>• Готово! Вы в системе</li></ul></div></div></div><div class="mt-6 text-center" data-v-4b734f36><p class="text-sm text-gray-600" data-v-4b734f36> Нет аккаунта? <span class="text-gray-800 font-medium" data-v-4b734f36>Попросите QR-код у администратора</span></p></div>',2))]),c.value?i("",!0):(a(),s("div",E,[...e[7]||(e[7]=[t("p",{class:"text-sm text-yellow-800 text-center"}," ⚠️ Ваше устройство не поддерживает биометрическую аутентификацию ",-1)])]))])]))}}),G=C(Q,[["__scopeId","data-v-4b734f36"]]);export{G as default};
