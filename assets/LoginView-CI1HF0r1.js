import{g as e,a,b as t,h as l,i as s,u as d,j as r,k as i,l as o,m as n,t as v,p as u,o as c}from"./vue-vendor-DH3SoYu2.js";import{u as m}from"./index-DnSONjdv.js";import{_ as f}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./supabase-DJmvsvGB.js";const b={class:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 to-purple-100 px-4"},p={class:"max-w-md w-full"},x={class:"bg-white rounded-2xl shadow-xl p-8"},h={key:0,class:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg"},g={key:1,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"},w={class:"flex items-start"},y={class:"flex-1"},k={class:"text-sm text-red-700 mt-1"},z=["disabled"],j={key:0,class:"animate-spin -ml-1 mr-3 h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24"},C={key:1,class:"w-6 h-6 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},L={key:2},M={key:3},_={key:0,class:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg"},B=f(e({__name:"LoginView",setup(e){const f=d(),B=s(),{login:H,isLoading:A,isAuthenticated:I}=m(),V=a(null),D=a(!1),Q=t(()=>void 0!==window.PublicKeyCredential);async function R(){V.value=null;try{await H(),f.push("/dashboard")}catch(e){e.message.includes("not found")||e.message.includes("NotAllowedError")?V.value="Устройство не зарегистрировано. Попросите QR-код для регистрации.":V.value=e.message||"Ошибка входа"}}return l(()=>{"true"===B.query.registered&&(D.value=!0,setTimeout(()=>{D.value=!1},5e3)),I.value&&f.push("/dashboard"),Q.value||(V.value="Ваше устройство не поддерживает биометрическую аутентификацию.")}),(e,a)=>(c(),r("div",b,[i("div",p,[i("div",x,[a[5]||(a[5]=n('<div class="text-center mb-8" data-v-4b734f36><div class="mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4" data-v-4b734f36><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-4b734f36><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" data-v-4b734f36></path></svg></div><h2 class="text-3xl font-bold text-gray-900" data-v-4b734f36>Вход</h2><p class="text-gray-600 mt-2" data-v-4b734f36>Войдите с помощью биометрии</p></div>',1)),D.value?(c(),r("div",h,[...a[0]||(a[0]=[n('<div class="flex items-start" data-v-4b734f36><svg class="w-5 h-5 text-green-600 mt-0.5 mr-3" fill="currentColor" viewBox="0 0 20 20" data-v-4b734f36><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" data-v-4b734f36></path></svg><div class="flex-1" data-v-4b734f36><p class="text-sm text-green-800" data-v-4b734f36>Вы успешно зарегистрированы! Теперь войдите в систему.</p></div></div>',1)])])):o("",!0),V.value?(c(),r("div",g,[i("div",w,[a[2]||(a[2]=i("svg",{class:"w-5 h-5 text-red-600 mt-0.5 mr-3",fill:"currentColor",viewBox:"0 0 20 20"},[i("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),i("div",y,[a[1]||(a[1]=i("h3",{class:"text-sm font-medium text-red-800"},"Ошибка",-1)),i("p",k,v(V.value),1)])])])):o("",!0),i("button",{onClick:R,disabled:u(A),class:"w-full py-4 px-6 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-medium rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center shadow-lg"},[u(A)?(c(),r("svg",j,[...a[3]||(a[3]=[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(c(),r("svg",C,[...a[4]||(a[4]=[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"},null,-1)])])),u(A)?(c(),r("span",M,"Вход...")):(c(),r("span",L,"Войти с биометрией"))],8,z),a[6]||(a[6]=n('<div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4" data-v-4b734f36><div class="flex items-start" data-v-4b734f36><svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20" data-v-4b734f36><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" data-v-4b734f36></path></svg><div class="flex-1" data-v-4b734f36><h4 class="text-sm font-medium text-blue-900" data-v-4b734f36>Как это работает</h4><ul class="mt-2 text-sm text-blue-800 space-y-1" data-v-4b734f36><li data-v-4b734f36>• Нажмите кнопку входа</li><li data-v-4b734f36>• Подтвердите вход через Face ID / Touch ID</li><li data-v-4b734f36>• Готово! Вы в системе</li></ul></div></div></div><div class="mt-6 text-center" data-v-4b734f36><p class="text-sm text-gray-600" data-v-4b734f36> Нет аккаунта? <span class="text-gray-800 font-medium" data-v-4b734f36>Попросите QR-код у администратора</span></p></div>',2))]),Q.value?o("",!0):(c(),r("div",_,[...a[7]||(a[7]=[i("p",{class:"text-sm text-yellow-800 text-center"}," ⚠️ Ваше устройство не поддерживает биометрическую аутентификацию ",-1)])]))])]))}}),[["__scopeId","data-v-4b734f36"]]);export{B as default};
