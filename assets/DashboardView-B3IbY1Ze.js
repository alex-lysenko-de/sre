import{u as e}from"./index-BoJqhDv6.js";import{g as t,a,b as s,h as o,j as l,k as i,t as r,p as n,s as d,c,l as u,x as g,r as m,F as p,y as v,o as x}from"./vue-vendor-DH3SoYu2.js";import{_ as h}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./supabase-DJmvsvGB.js";const f={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},w={class:"bg-white rounded-lg shadow-md p-6 mb-6"},y={class:"text-3xl font-bold text-gray-900"},b={class:"text-gray-600 mt-2"},k={class:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg shadow-md p-6 mb-6 text-white"},j={class:"flex items-center justify-between"},M={class:"mt-2 text-indigo-100"},C=["disabled"],z={key:1,class:"text-center"},D={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},_={class:"bg-white rounded-lg shadow-md p-6"},S={class:"flex items-center"},B={class:"ml-4"},I={class:"text-2xl font-bold text-gray-900"},H={class:"bg-white rounded-lg shadow-md p-6"},L={class:"flex items-center"},R={class:"ml-4"},V={class:"text-2xl font-bold text-gray-900"},T={class:"bg-white rounded-lg shadow-md p-6"},U={class:"flex items-center"},q={class:"ml-4"},A={class:"text-2xl font-bold text-gray-900"},E={class:"bg-white rounded-lg shadow-md p-6"},F={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},G={class:"bg-white rounded-lg shadow-md p-6 mt-6"},N={class:"space-y-4"},J={class:"flex-1"},K={class:"text-sm font-medium text-gray-900"},O={class:"text-xs text-gray-500"},P={key:0,class:"text-gray-500 text-sm text-center py-4"},Q=h(t({__name:"DashboardView",setup(t){const{user:h,apiRequest:Q,login:W}=e(),X=a(!1),Y=a(!1),Z=a({activeDevices:0,loginStreak:0}),$=a([]),ee=s(()=>h.value?(new Date).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Неизвестно");async function te(){try{const e=await Q("/devices/count",{method:"GET"}),t=await e.json();Z.value.activeDevices=t.count||0,Z.value.loginStreak=Math.floor(30*Math.random())+1,$.value=[{action:"Вход в систему",timestamp:"Сегодня, "+(new Date).toLocaleTimeString("ru-RU")}]}catch(e){}}async function ae(){X.value=!0;try{await W();const e=(new Date).toDateString();localStorage.setItem("lastCheckIn",e),Y.value=!0,$.value.unshift({action:"Ежедневная отметка",timestamp:"Только что"})}catch(e){alert("Ошибка при отметке")}finally{X.value=!1}}async function se(){try{await W(),await te()}catch(e){}}return o(async()=>{await te(),function(){const e=localStorage.getItem("lastCheckIn"),t=(new Date).toDateString();Y.value=e===t}()}),(e,t)=>{const a=m("router-link");return x(),l("div",f,[i("div",w,[i("h1",y," Добро пожаловать, "+r(n(h)?.displayName)+"! ",1),i("p",b," Последний вход: "+r(ee.value),1)]),i("div",k,[i("div",j,[i("div",null,[t[0]||(t[0]=i("h2",{class:"text-2xl font-bold"},"Ежедневная отметка",-1)),i("p",M,r(Y.value?"Вы уже отметились сегодня!":"Отметьтесь, чтобы продолжить"),1)]),i("div",null,[Y.value?(x(),l("div",z,[...t[1]||(t[1]=[i("svg",{class:"w-16 h-16 text-white mx-auto",fill:"currentColor",viewBox:"0 0 20 20"},[i("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),i("p",{class:"mt-2 font-medium"},"Отмечено ✓",-1)])])):(x(),l("button",{key:0,onClick:ae,disabled:X.value,class:"bg-white text-indigo-600 font-semibold px-6 py-3 rounded-lg hover:bg-indigo-50 transition disabled:opacity-50"},r(X.value?"Отметка...":"Отметиться"),9,C))])])]),i("div",D,[i("div",_,[i("div",S,[t[3]||(t[3]=i("div",{class:"p-3 bg-blue-100 rounded-lg"},[i("svg",{class:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})])],-1)),i("div",B,[t[2]||(t[2]=i("p",{class:"text-sm font-medium text-gray-600"},"Активных устройств",-1)),i("p",I,r(Z.value.activeDevices),1)])])]),i("div",H,[i("div",L,[t[5]||(t[5]=i("div",{class:"p-3 bg-green-100 rounded-lg"},[i("svg",{class:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),i("div",R,[t[4]||(t[4]=i("p",{class:"text-sm font-medium text-gray-600"},"Дней подряд",-1)),i("p",V,r(Z.value.loginStreak),1)])])]),i("div",T,[i("div",U,[t[7]||(t[7]=i("div",{class:"p-3 bg-purple-100 rounded-lg"},[i("svg",{class:"w-8 h-8 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1)),i("div",q,[t[6]||(t[6]=i("p",{class:"text-sm font-medium text-gray-600"},"Статус аккаунта",-1)),i("p",A,r("admin"===n(h)?.role?"Админ":"Активен"),1)])])])]),i("div",E,[t[12]||(t[12]=i("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Быстрые действия",-1)),i("div",F,[d(a,{to:"/profile",class:"flex items-center p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition"},{default:g(()=>[...t[8]||(t[8]=[i("svg",{class:"w-6 h-6 text-indigo-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1),i("span",{class:"font-medium text-gray-900"},"Профиль",-1)])]),_:1}),d(a,{to:"/devices",class:"flex items-center p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition"},{default:g(()=>[...t[9]||(t[9]=[i("svg",{class:"w-6 h-6 text-indigo-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),i("span",{class:"font-medium text-gray-900"},"Устройства",-1)])]),_:1}),"admin"===n(h)?.role?(x(),c(a,{key:0,to:"/admin",class:"flex items-center p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition"},{default:g(()=>[...t[10]||(t[10]=[i("svg",{class:"w-6 h-6 text-indigo-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),i("span",{class:"font-medium text-gray-900"},"Админ-панель",-1)])]),_:1})):u("",!0),i("button",{onClick:se,class:"flex items-center p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition"},[...t[11]||(t[11]=[i("svg",{class:"w-6 h-6 text-indigo-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),i("span",{class:"font-medium text-gray-900"},"Обновить",-1)])])])]),i("div",G,[t[13]||(t[13]=i("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Последняя активность",-1)),i("div",N,[(x(!0),l(p,null,v($.value,(e,t)=>(x(),l("div",{key:t,class:"flex items-start border-l-4 border-indigo-500 pl-4 py-2"},[i("div",J,[i("p",K,r(e.action),1),i("p",O,r(e.timestamp),1)])]))),128)),0===$.value.length?(x(),l("p",P," Нет активности ")):u("",!0)])])])}}}),[["__scopeId","data-v-bae66fb0"]]);export{Q as default};
