
---

## üß© 1. –û–±—â–∞—è –∏–¥–µ—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è **—É—á–µ—Ç–∞ –¥–µ—Ç–µ–π** –≤ —Ä–∞–∑–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö (–∞–≤—Ç–æ–±—É—Å, –ø—Ä–æ–≥—É–ª–∫–∞, –ª–∞–≥–µ—Ä—å –∏ —Ç. –¥.).
–ö–∞–∂–¥—ã–π —Ä–µ–±—ë–Ω–æ–∫ –∏–º–µ–µ—Ç **–±—Ä–∞—Å–ª–µ—Ç —Å QR-–∫–æ–¥–æ–º**, –≥–¥–µ –∫–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π **–Ω–æ–º–µ—Ä –±—Ä–∞—Å–ª–µ—Ç–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä: `001`, `002`, `100`).

**–§–æ—Ä–º–∞—Ç QR-—Å—Å—ã–ª–∫–∏:**

```
https://base_app_url/?n=001
```

–ü–∞—Ä–∞–º–µ—Ç—Ä `n` ‚Äî —ç—Ç–æ `ID –±—Ä–∞—Å–ª–µ—Ç–∞` ‚Üí –ø–æ –Ω–µ–º—É –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–µ–±—ë–Ω–æ–∫.
base_app_url == sre-nrw.de
(formelly: base_app_url == alex-lysenko-de/github.io/sre)


---

## üóÉÔ∏è 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `children` (–¥–µ—Ç–∏)

create table public.children (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  name character varying null,
  age smallint null default '0'::smallint,
  schwimmer smallint null default '0'::smallint,
  status smallint null default '0'::smallint,
  notes text null default ''::text,
  group_id bigint null,
  band_id bigint null,
  constraint children_pkey primary key (id),
  constraint children_band_id_fkey foreign KEY (band_id) references c_bands (id),
  constraint children_group_id_fkey foreign KEY (group_id) references groups (id) on delete set null
) TABLESPACE pg_default;


---

### –¢–∞–±–ª–∏—Ü–∞ `users` (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
create table public.users (
  id bigserial not null,
  user_id uuid null,
  email text not null,
  phone text null,
  display_name text not null,
  role text not null,
  active boolean null default true,
  last_seen_date timestamp with time zone null,
  created_at timestamp with time zone null default now(),
  updated_at timestamp with time zone null default now(),
  constraint users_pkey1 primary key (id),
  constraint users_email_key unique (email),
  constraint users_user_id_fkey foreign KEY (user_id) references auth.users (id) on delete set null,
  constraint users_role_check check ((role = any (array['admin'::text, 'user'::text])))
) TABLESPACE pg_default;

create index IF not exists idx_users_user_id on public.users using btree (user_id) TABLESPACE pg_default;

create index IF not exists idx_users_email on public.users using btree (email) TABLESPACE pg_default;




---

### –¢–∞–±–ª–∏—Ü–∞ `scans` (—Å–∫–∞–Ω—ã)

create table public.scans (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  date character varying not null,
  user_id bigint null,
  child_id bigint null,
  band_id bigint null,
  bus_id smallint null,
  type smallint null default '1'::smallint,
  constraint scans_pkey primary key (id),
  constraint scans_band_id_fkey foreign KEY (band_id) references c_bands (id) on update CASCADE on delete set null,
  constraint scans_child_id_fkey foreign KEY (child_id) references children (id) on update CASCADE on delete CASCADE,
  constraint scans_type_fkey foreign KEY (type) references scan_type (id) on update CASCADE on delete set null,
  constraint scans_user_id_fkey foreign KEY (user_id) references users (id) on update CASCADE on delete set null,
) TABLESPACE pg_default;


public.scans.date == public.days.date

create table public.days (
  id bigint generated by default as identity not null,
  created_at timestamp with time zone not null default now(),
  date character varying null,
  name character varying null,
  abfahrt time without time zone null,
  ankommen time without time zone null,
  description text null,
  constraint days_pkey primary key (id)
) TABLESPACE pg_default;
---

## üîê 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ä–æ–ª–∏

–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

* **guest** ‚Äî –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π, ‚Äú–ª–µ–≤—ã–π‚Äù —á–µ–ª–æ–≤–µ–∫. –ò–º–µ–µ—Ç –ø—Ä–∞–≤–æ —Ç–æ–ª—å–∫–æ –Ω–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã /info
* **user** ‚Äî –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ—Å–ø–∏—Ç–∞—Ç–µ–ª—å). –ò–º–µ–µ—Ç –ø—Ä–∞–≤–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –±—Ä–∞—Å–ª–µ—Ç—ã –¥–µ—Ç–µ–π, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –¥–µ—Ç–µ–π, –ø—Ä–∏–≤—è–∑–∫–∞ –¥–µ—Ç–µ–π –∫ –±—Ä–∞—Å–ª–µ—Ç—É, –∫ –∞–≤—Ç–æ–±—É—Å—É, –∫ –≥—Ä—É–ø–ø–µ
* **admin** ‚Äî –∏–º–µ–µ—Ç –≤—Å–µ –ø—Ä–∞–≤–∞ `user` + –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).

---

## üß≠ 4. –õ–æ–≥–∏–∫–∞ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ QR-–∫–æ–¥–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É –≤–∏–¥–∞:

```
https://sre-nrw.de/?n=1
https://sre-nrw.de/?n=42
https://sre-nrw.de/?n=100
```

–î–∞–ª–µ–µ —Å–µ—Ä–≤–µ—Ä –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### 1Ô∏è‚É£ –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–æ–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

* –ï—Å–ª–∏ **–Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω** ‚Üí `role = guest`
* –ï—Å–ª–∏ **–∑–∞–ª–æ–≥–∏–Ω–µ–Ω** ‚Üí —Ä–æ–ª—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users.role`

---

### 2Ô∏è‚É£ –í–µ—Ç–≤–ª–µ–Ω–∏—è –ø–æ —Ä–æ–ª—è–º

#### **guest**

* –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É `/info?n=42`
* –í –ë–î **–Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è**

---

#### **user / admin**

1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ `arm_band_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `children`

   * **–ï—Å–ª–∏ –Ω–µ—Ç:**

     * –°–æ–æ–±—â–µ–Ω–∏–µ:

       > "–ë—Ä–∞—Å–ª–µ—Ç –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —Ä–µ–±—ë–Ω–∫—É. –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–∏–≤—è–∑–∫—É?"
     * –ö–Ω–æ–ø–∫–∏:

       * "Zur√ºck"
       * "Ja" ‚Üí –≤–µ–¥—ë—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äú–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±—ë–Ω–∫–∞‚Äù
         (–≥–¥–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –∏–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å –±—Ä–∞—Å–ª–µ—Ç)
   * **–ï—Å–ª–∏ –¥–∞:**

     * –ù–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

       ```
       Gruppe: {gruppe}
       Name: {vorname} {name}
	   Alter: {age}
       Schwimmer: {ja/nein}
	   
       ```
     * –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ç–∞–±–ª–∏—Ü—É `scans`:

       * `arm_band_id`
       * `child_id`
       * `user_id`
       * `scan_time = NOW()`
	   * `date` = date(NOW(), "YYYY-MM-DD")

---

## üñ•Ô∏è 5. –õ–æ–≥–∏–∫–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

–ü–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞ –Ω–∞ `/` –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏:

| –†–æ–ª—å  | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã                               |
| ----- | --------------------------------------------------------- |
| guest | –¢–æ–ª—å–∫–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è 				                        |
| user  | –°–ø–∏—Å–æ–∫ –¥–µ—Ç–µ–π / –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å QR /–¥–æ–±–∞–≤–ª—è—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –≤ —Å–∏—Å—Ç–µ–º—É / –¥–µ–ª–∞—Ç—å –∑–∞–º–µ–Ω—É –±—Ä–∞—Å–ª–µ—Ç–æ–≤
| admin | –í—Å—ë –∫–∞–∫ —É user + —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ / –¥–µ—Ç—å–º–∏       |

---

