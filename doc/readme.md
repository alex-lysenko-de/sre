# WebAuthn Authentication App

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å WebAuthn (Face ID / Touch ID / –±–∏–æ–º–µ—Ç—Ä–∏—è), QR-–∫–æ–¥–∞–º–∏ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ PWA –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- ‚úÖ **WebAuthn –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ –±–∏–æ–º–µ—Ç—Ä–∏—é (Face ID, Touch ID, Windows Hello)
- ‚úÖ **QR-–∫–æ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ invite tokens
- ‚úÖ **PWA** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- ‚úÖ **Offline-first** - Service Worker –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **Role-based access** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∞–≤ (user/admin)
- ‚úÖ **Multi-device** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- ‚úÖ **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –æ—Ç–º–µ—Ç–∫–∞** - —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞ —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏
- ‚úÖ **Secure Storage** - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18+
- Supabase –∞–∫–∫–∞—É–Ω—Ç
- HTTPS –¥–æ–º–µ–Ω (–¥–ª—è WebAuthn –≤ production)

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase

#### 2.1 –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Supabase

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ https://supabase.com
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL –∏ –∫–ª—é—á–∏

#### 2.2 –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã

–í—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∏–∑ —Ñ–∞–π–ª–∞ `database-schema.sql` –≤ SQL Editor Supabase.

#### 2.3 –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Edge Function

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase CLI
npm install -g supabase

# –í–æ–π—Ç–∏
supabase login

# –°–≤—è–∑–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
supabase link --project-ref your-project-ref

# –°–æ–∑–¥–∞—Ç—å Edge Function
supabase functions new auth

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏–∑ edge_function_auth.ts –≤ functions/auth/index.ts

# –î–µ–ø–ª–æ–π
supabase functions deploy auth

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã
supabase secrets set JWT_SECRET=your-random-secret-key-here
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env`:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è:

```env
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
VITE_API_BASE_URL=https://your-project.supabase.co/functions/v1/auth
```

### 4. –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ

```bash
npm run dev
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ `http://localhost:3000`

‚ö†Ô∏è **–í–∞–∂–Ω–æ**: WebAuthn —Ç—Ä–µ–±—É–µ—Ç HTTPS –≤ production. –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- `localhost` (—Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ HTTPS)
- ngrok –¥–ª—è HTTPS —Ç—É–Ω–Ω–µ–ª—è: `ngrok http 3000`

## üì¶ Production Build

```bash
npm run build
```

–ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –±—É–¥—É—Ç –≤ –ø–∞–ø–∫–µ `dist/`.

## üåê –î–µ–ø–ª–æ–π

### Vercel

```bash
npm install -g vercel
vercel
```

### Netlify

```bash
npm install -g netlify-cli
netlify deploy --prod
```

### Cloudflare Pages

```bash
npm run build
# –ó–∞–≥—Ä—É–∑–∏—Ç—å dist/ —á–µ—Ä–µ–∑ Cloudflare Pages Dashboard
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** –¥–ª—è WebAuthn –≤ production
2. **Service Role Key** —Ö—Ä–∞–Ω–∏—Ç—Å—è –¢–û–õ–¨–ö–û –≤ Edge Functions
3. **JWT Secret** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å–ª—É—á–∞–π–Ω—ã–º (–º–∏–Ω–∏–º—É–º 32 –±–∞–π—Ç–∞)
4. **Invite —Ç–æ–∫–µ–Ω—ã** –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∏ —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Å—Ä–æ–∫–æ–º –∂–∏–∑–Ω–∏
5. **RLS (Row Level Security)** –≤–∫–ª—é—á–µ–Ω –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤:

```bash
# JWT Secret
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"

# Invite Token (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ Edge Function)
node -e "console.log(require('crypto').randomBytes(32).toString('base64url'))"
```

## üì± PWA –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### iOS (Safari)

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Safari
2. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" (–∫–≤–∞–¥—Ä–∞—Ç —Å–æ —Å—Ç—Ä–µ–ª–∫–æ–π –≤–≤–µ—Ä—Ö)
3. –í—ã–±—Ä–∞—Ç—å "–ù–∞ —ç–∫—Ä–∞–Ω –î–æ–º–æ–π"
4. –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å"

### Android (Chrome)

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Chrome
2. –ù–∞–∂–∞—Ç—å –º–µ–Ω—é (—Ç—Ä–∏ —Ç–æ—á–∫–∏)
3. –í—ã–±—Ä–∞—Ç—å "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ" –∏–ª–∏ "–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω"

### Desktop (Chrome/Edge)

1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ù–∞–∂–∞—Ç—å –∏–∫–æ–Ω–∫—É —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ
3. –ò–ª–∏: –ú–µ–Ω—é ‚Üí "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å [–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è]"

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

1. –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞ –≤ –ë–î –≤—Ä—É—á–Ω—É—é:

```sql
INSERT INTO public.users (display_name, role, active)
VALUES ('Admin User', 'admin', TRUE);
```

2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ QR-–∫–æ–¥ (—Å–æ–∑–¥–∞—Ç—å invite —á–µ—Ä–µ–∑ SQL –∏–ª–∏ API)
3. –í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å `/admin`
4. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å QR-–∫–æ–¥—ã –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. –ü–æ–ª—É—á–∏—Ç—å QR-–∫–æ–¥ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –û—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å QR ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –í–≤–µ—Å—Ç–∏ –∏–º—è –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —á–µ—Ä–µ–∑ –±–∏–æ–º–µ—Ç—Ä–∏—é
4. –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ –±–∏–æ–º–µ—Ç—Ä–∏—é

## üîß Troubleshooting

### WebAuthn –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTPS (–∏–ª–∏ localhost)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –±—Ä–∞—É–∑–µ—Ä–æ–º: https://caniuse.com/webauthn
- –í–∫–ª—é—á–∏—Ç—å –±–∏–æ–º–µ—Ç—Ä–∏—é –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### Edge Function –æ—à–∏–±–∫–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
supabase functions logs auth

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
supabase secrets list
```

### Service Worker –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

- –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
- Unregister Service Worker –≤ DevTools
- Hard reload (Ctrl+Shift+R / Cmd+Shift+R)

## üìö API Endpoints

### Edge Function `/auth`

- `POST /register/prepare` - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `POST /register/finish` - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `POST /login/prepare` - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Ö–æ–¥–∞
- `POST /login/finish` - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Ö–æ–¥–∞
- `POST /invite/generate` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è invite (admin)
- `GET /users` - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (admin)
- `POST /user/toggle-status` - –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è (admin)
- `GET /devices/count` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## üìÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ assets/          # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ components/      # Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ composables/     # Composables (useAuth)
‚îÇ   ‚îú‚îÄ‚îÄ router/          # Vue Router
‚îÇ   ‚îú‚îÄ‚îÄ views/           # –°—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îú‚îÄ‚îÄ App.vue          # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ main.ts          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ icons/           # PWA –∏–∫–æ–Ω–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ manifest.json    # PWA manifest
‚îÇ   ‚îî‚îÄ‚îÄ service-worker.js # Service Worker
‚îú‚îÄ‚îÄ supabase/
‚îÇ   ‚îî‚îÄ‚îÄ functions/
‚îÇ       ‚îî‚îÄ‚îÄ auth/        # Edge Function
‚îú‚îÄ‚îÄ database-schema.sql  # SQL —Å—Ö–µ–º–∞
‚îî‚îÄ‚îÄ vite.config.ts       # Vite –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

## ü§ù Contributing

Pull requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

## üìù License

MIT

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏ —É–¥–æ–±–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [WebAuthn Guide](https://webauthn.guide/)
- [Supabase Docs](https://supabase.com/docs)
- [Vue 3 Docs](https://vuejs.org/)
- [PWA Best Practices](https://web.dev/progressive-web-apps/)